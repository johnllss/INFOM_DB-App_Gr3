{% extends "layout.html" %}

{% block title %}
    Subscription Confirmation
{% endblock %}

{% block main %}
    <div class="text-left ms-5 me-5 mt-5 mb-2">
        <h1 style="font-size: 70px;"><strong>Subscription Confirmation</strong></h1>
        <p class="lead mt-5 text-center">You are about to subscribe to the <strong style="color: {{ color }};">{{ tier }}</strong> membership</p>
    </div>

    <div class="container" style="max-width: 600px;">
        <div class="card shadow-lg border-0 round-4 px-5 py-5">
            <div class="mb-4">Subscription Details</div>

            <div class="mb-3">
                <strong>Tier:</strong> {{ tier }}
            </div>
            <div class="mb-3">
                <strong>Monthly Price: </strong>₱{{ "{:,.0f}".format(price/1000) }}k
            </div>
            <div class="mb-3">
                <strong>Discount on Sessions:</strong> {{ discount }}%
            </div>
            <div class="mb-4">
                <strong>Duration:</strong>
                <select name="months" id="months" class="form-select" onchange="updateTotal()">
                    <option value="1">1 Month</option>
                    <option value="2">2 Month</option>
                    <option value="3">3 Month</option>
                    <option value="4">4 Month</option>
                    <option value="5">5 Month</option>
                    <option value="6">6 Month</option>
                    <option value="7">7 Month</option>
                    <option value="8">8 Month</option>
                    <option value="9">9 Month</option>
                    <option value="10">10 Month</option>
                    <option value="11">11 Month</option>
                    <option value="12">12 Month</option>
                </select>
            </div>
            <div class="mb-4">
                <h4>Total: ₱<span id="total">{{ "{:,.0f}".format(price/1000) }}</span>k</h4>
            </div>

            <form action="/subscribe/add_subscription_to_cart" method="post">
                <input type="hidden" name="tier" value="{{ tier }}">
                <input type="hidden" name="price" value="{{ price }}">
                <input type="hidden" name="discount" value="{{ discount }}">
                <input type="hidden" id="months_input" name="months" value="1">

                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-success btn-lg">Add  Subscription To Cart</button>
                    <a href="/membership" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        function updateTotal() {
            const months = parseInt(document.getElementById('months').value);
            const basePrice = {{ price }};
            const total = (basePrice * months) / 1000;
            document.getElementById('total').textContent = total.toLocaleString('en-US', {maximumFractionDigits: 0});
            document.getElementById('months_input').value = months;
        }
    </script>
{% endblock %}